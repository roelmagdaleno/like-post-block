let lpbTimerId,lpbLike=0;function lpb_debounce(t,e){return function(...s){lpbTimerId&&clearTimeout(lpbTimerId),lpbTimerId=setTimeout((()=>{t.apply(this,s)}),e)}}function lbp_animateIcon(){const t=document.querySelector(".wp-like-post__button svg");t&&(t.style.transform="scale(1.1)",setTimeout((()=>t.style.transform="scale(1.0)"),100))}function lpb_replaceIcon(){const t=document.querySelector(".wp-like-post__button");t&&!t.classList.contains("wp-like-post__button--liked")&&(t.classList.add("wp-like-post__button--liked"),t.innerHTML=LPB.icons.active)}function lpb_getXHR(t){const e=new XMLHttpRequest;return e.open("POST",t,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e}let lpbPost=function(){function t(t){Object.freeze(t),Object.defineProperties(this,{likes:{value:{total:t.likes.total,fromUser:t.likes.fromUser},writable:!0},_settings:{value:t}})}return t.prototype.like=function(){if(parseInt(this.likes.fromUser)>=parseInt(this._settings.limit))return;lpbLike++,this.likes.fromUser++;const t=parseInt(this.likes.total);document.querySelector(".wp-like-post__count").innerHTML=(t+lpbLike).toString();lpb_debounce((()=>{const t=lpb_getXHR(this._settings.url);t.onload=()=>{t.status>=200&&t.status<400&&(this.likes.total=this.likes.total+lpbLike,lpbLike=0)};const e=this._settings.post_id,s=this._settings.nonces.likePost;t.send(`action=lpb_like_post&post_id=${e}&count=${lpbLike}&nonce=${s}`)}),500)(),lpb_replaceIcon(),lbp_animateIcon()},t.prototype.getLikes=function(){const t=lpb_getXHR(this._settings.url);t.onload=()=>{if(t.status>=200&&t.status<400){const e=JSON.parse(t.responseText),s=document.querySelector(".wp-like-post__count"),n=document.querySelector(".wp-like-post__button");if(!s||!n)return;const i=parseInt(e.data.likes);if(i===parseInt(this.likes.total))return;i>0&&(n.classList.add("wp-like-post__button--liked"),n.innerHTML=LPB.icons.active),s.innerHTML=i.toString()}};const e=this._settings.post_id,s=this._settings.nonces.getLikes,n=JSON.stringify(this._settings.block);t.send(`action=lpb_get_post_likes&post_id=${e}&nonce=${s}&attributes=${n}`)},t}();document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelector(".wp-like-post__button");if(!t||!window.LPB)return;const e=new lpbPost(window.LPB);LPB.attributes.renderWithAjax&&e.getLikes(),t.addEventListener("click",(()=>e.like()))}));