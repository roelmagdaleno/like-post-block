let lpbTimerId,rolpbLike=0;function rolpb_debounce(t,e){return function(...s){lpbTimerId&&clearTimeout(lpbTimerId),lpbTimerId=setTimeout((()=>{t.apply(this,s)}),e)}}function rolbp_animateIcon(){const t=document.querySelector(".wp-like-post__button svg");t&&(t.style.transform="scale(1.1)",setTimeout((()=>t.style.transform="scale(1.0)"),100))}function rolpb_replaceIcon(){const t=document.querySelector(".wp-like-post__button");t&&!t.classList.contains("wp-like-post__button--liked")&&(t.classList.add("wp-like-post__button--liked"),t.innerHTML=ROLPB.icons.active)}function rolpb_getXHR(t){const e=new XMLHttpRequest;return e.open("POST",t,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e}let lpbPost=function(){function t(t){Object.freeze(t),Object.defineProperties(this,{likes:{value:{total:t.likes.total,fromUser:t.likes.fromUser},writable:!0},_settings:{value:t}})}return t.prototype.like=function(){if(parseInt(this.likes.fromUser)>=parseInt(this._settings.limit))return;rolpbLike++,this.likes.fromUser++;const t=parseInt(this.likes.total);document.querySelector(".wp-like-post__count").innerHTML=(t+rolpbLike).toString();rolpb_debounce((()=>{const t=rolpb_getXHR(this._settings.url);t.onload=()=>{t.status>=200&&t.status<400&&(this.likes.total=this.likes.total+rolpbLike,rolpbLike=0)};const e=this._settings.post_id,s=this._settings.nonces.likePost;t.send(`action=rolpb_like_post&post_id=${e}&count=${rolpbLike}&nonce=${s}`)}),500)(),rolpb_replaceIcon(),rolbp_animateIcon()},t.prototype.getLikes=function(){const t=rolpb_getXHR(this._settings.url);t.onload=()=>{if(t.status>=200&&t.status<400){const e=JSON.parse(t.responseText),s=document.querySelector(".wp-like-post__count"),o=document.querySelector(".wp-like-post__button");if(!s||!o)return;const n=parseInt(e.data.likes);if(n===parseInt(this.likes.total))return;n>0&&(o.classList.add("wp-like-post__button--liked"),o.innerHTML=ROLPB.icons.active),s.innerHTML=n.toString()}};const e=this._settings.post_id,s=this._settings.nonces.getLikes,o=JSON.stringify(this._settings.block);t.send(`action=rolpb_get_post_likes&post_id=${e}&nonce=${s}&attributes=${o}`)},t}();document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelector(".wp-like-post__button");if(!t||!window.ROLPB)return;const e=new lpbPost(window.ROLPB);ROLPB.attributes.renderWithAjax&&e.getLikes(),t.addEventListener("click",(()=>e.like()))}));