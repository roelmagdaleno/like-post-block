let rolpbTimerId;function rolpb_debounce(t,e){return function(...i){rolpbTimerId&&clearTimeout(rolpbTimerId),rolpbTimerId=setTimeout((()=>{t.apply(this,i)}),e)}}function rolbp_animateIcon(t){const e=t.querySelector("svg");e&&(e.style.transform="scale(1.1)",setTimeout((()=>e.style.transform="scale(1.0)"),100))}function rolpb_replaceIcon(t,e="active"){t&&("active"===e&&t.classList.contains("wp-like-post__button--liked")||("active"===e&&t.classList.add("wp-like-post__button--liked"),"inactive"===e&&t.classList.remove("wp-like-post__button--liked"),t.innerHTML=ROLPB.icons[e]))}function rolpb_getXHR(t){const e=new XMLHttpRequest;return e.open("POST",t,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e}function rolpb_getBulkLikes(t,e){const i=rolpb_getXHR(e.url);i.onload=()=>{if(i.status>=200&&i.status<400){const s=JSON.parse(i.responseText);if(s.success){const i=s.data;t.forEach((t=>{const s=document.querySelector(`.wp-like-post__button[data-post-id="${t}"]`);if(!s)return;const o=s.parentElement.querySelector(".wp-like-post__count");if(!o)return;const n=parseInt(i[t]);n!==parseInt(s.getAttribute("data-total-likes"))&&(n>0&&(s.classList.add("wp-like-post__button--liked"),s.innerHTML=e.icons.active),o.innerHTML=n.toString())}))}}};const s=e.nonces.getLikes,o=JSON.stringify(e.block);i.send(`action=rolpb_get_post_likes&post_ids=${t}&nonce=${s}&attributes=${o}`)}let lpbPost=function(){function t(t,e){e.limit="1"===e.likeUnlike?1:e.limit,Object.freeze(e);const i=parseInt(t.getAttribute("data-post-id")),s={total:parseInt(t.getAttribute("data-total-likes")),fromUser:parseInt(t.getAttribute("data-likes-from-user"))};Object.defineProperties(this,{likeButton:{value:t},postId:{value:i},isLikingPost:{value:!1,writable:!0},isUnlikingPost:{value:!1,writable:!0},likes:{value:{total:s.total,fromUser:s.fromUser,toAdd:0},writable:!0},_settings:{value:e}})}return t.prototype.like=function(){if(this.isUnlikingPost)return;if(""===this._settings.unlimited&&this.likes.fromUser>=parseInt(this._settings.limit))return;this.isLikingPost=!0,this.likes.toAdd++,this.likes.fromUser++;const t=this.likes.total;if(""===this._settings.likeUnlike){this.likeButton.parentElement.querySelector(".wp-like-post__count").innerHTML=(t+this.likes.toAdd).toString()}rolpb_debounce((()=>{const t=rolpb_getXHR(this._settings.url);t.onload=()=>{t.status>=200&&t.status<400&&(this.likes.total=this.likes.total+this.likes.toAdd,this.likes.toAdd=0,this.likeButton.dataset.totalLikes=this.likes.total.toString(),"1"===this._settings.likeUnlike&&this.likeButton.addEventListener("click",(()=>this.unlike()),{once:!0}))};const e=this.postId,i=this._settings.nonces.likePost;t.send(`action=rolpb_like_post&post_id=${e}&count=${this.likes.toAdd}&nonce=${i}`)}),500)(),rolpb_replaceIcon(this.likeButton),rolbp_animateIcon(this.likeButton),this.isLikingPost=!1},t.prototype.unlike=function(){if(this.isLikingPost||this.isUnlikingPost)return;this.isUnlikingPost=!0;rolpb_debounce((()=>{const t=rolpb_getXHR(this._settings.url);t.onload=()=>{t.status>=200&&t.status<400&&(this.likes.total=this.likes.total-1<=0?0:this.likes.total-1,this.likes.fromUser=0,this.likeButton.dataset.totalLikes=this.likes.total.toString(),this.likeButton.addEventListener("click",(()=>this.like()),{once:!0}))};const e=this.postId,i=this._settings.nonces.unlikePost;t.send(`action=rolpb_unlike_post&post_id=${e}&count=${this.likes.fromUser||1}&nonce=${i}`)}),500)(),rolpb_replaceIcon(this.likeButton,"inactive"),rolbp_animateIcon(this.likeButton),this.isUnlikingPost=!1},t.prototype.getLikes=function(){rolpb_getBulkLikes([this.postId],this._settings)},t}();document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelectorAll(".wp-like-post__button");if(0===t.length||!window.ROLPB)return;let e=[];t.forEach((t=>{let i=new lpbPost(t,window.ROLPB);if(i._settings.attributes.renderWithAjax&&e.push(i.postId),"1"===i._settings.likeUnlike&&i.likes.fromUser>0)return void t.addEventListener("click",(()=>i.unlike()),{once:!0});const s="1"===i._settings.likeUnlike;t.addEventListener("click",(()=>i.like()),{once:s})})),0!==e.length&&rolpb_getBulkLikes(e,window.ROLPB)}));